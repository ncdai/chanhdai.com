# AI Agent Guidelines for chanhdai.com

This guide provides essential information for AI agents working with the chanhdai.com codebase - a Next.js dev portfolio, blog, and component registry website.

## Project Overview

**chanhdai.com** is a minimal, pixel-perfect dev portfolio, component registry, and blog built with modern web technologies. It serves as:

- Personal portfolio for Nguyen Chanh Dai (@ncdai)
- Component registry using shadcn/ui system
- Blog with MDX content
- Showcase for custom React components

### Key Features

- **Clean & modern design** - Minimalist interface with attention to detail
- **Light/Dark themes** - Seamless theme switching with system preference support
- **vCard integration** - Downloadable contact card
- **SEO optimized** - JSON-LD schema, sitemap, robots.txt
- **AI-ready** - Supports /llms.txt for AI agent accessibility
- **Spam-protected email** - Encoded contact information
- **PWA support** - Installable as Progressive Web App
- **Blog system** - MDX/Markdown support with syntax highlighting, dynamic OG images, RSS feed
- **Component registry** - Reusable components distributed via shadcn CLI

### Tech Stack

- **Framework**: Next.js 16 (App Router)
- **Styling**: Tailwind CSS v4
- **UI Components**: shadcn/ui + custom components
- **Package Manager**: pnpm
- **Language**: TypeScript
- **Content**: MDX for blog posts
- **Deployment**: Vercel

## Project Structure

### Key Directories

```
src/
├── app/                    # Next.js App Router pages
│   ├── (app)/             # Main app routes
│   ├── (llms)/            # LLM-related routes
│   ├── og/                # Open Graph image generation
│   └── rss/               # RSS feed generation
├── components/            # Shared UI components
├── registry/              # Component registry source
├── __registry__/          # Auto-generated registry files (DO NOT EDIT)
├── features/              # Feature-based modules
│   ├── blog/              # Blog functionality
│   └── portfolio/         # User portfolio data
├── hooks/                 # Custom React hooks
├── lib/                   # Utility libraries
└── styles/                # Global styles
packages/
└── ncdai/                 # Publishable component package
```

### Important Files

- `src/config/site.ts` - Site configuration and navigation
- `src/config/registry.ts` - Registry configuration
- `src/features/portfolio/data/user.ts` - User portfolio data
- `src/registry/index.ts` - Registry entry point
- `components.json` - shadcn/ui configuration

## Component Registry System

The project features a custom component registry built on top of shadcn/ui:

### Registry Structure

- **Components** (`src/registry/registry-components.ts`) - UI components
- **Hooks** (`src/registry/registry-hook.ts`) - Custom React hooks
- **Blocks** (`src/registry/registry-blocks.ts`) - Pre-built blocks and sections
- **Examples** (`src/registry/registry-examples.ts`) - Component demos
- **Lib** (`src/registry/registry-lib.ts`) - Utility functions

### Registry Types

- `registry:component` - Reusable UI components
- `registry:hook` - Custom React hooks
- `registry:block` - Pre-built blocks and sections
- `registry:example` - Component examples/demos
- `registry:lib` - Utility libraries

### Available Components

1. **theme-switcher** - Theme switching component
2. **flip-sentences** - Text animation component
3. **apple-hello-effect** - Apple-style writing effect
4. **wheel-picker** - iOS-like wheel picker
5. **work-experience** - Work experience display
6. **shimmering-text** - Shimmering text animation
7. **slide-to-unlock** - iOS-style slide to unlock component
8. **scroll-fade-effect** - Adds fade effect to content as you scroll
9. **github-stars** - GitHub repository stars display component
10. **testimonials-marquee** - Testimonials marquee component
11. **use-controllable-state** - State management hook
12. **use-sound** - Sound effects hook
13. **utils** - Utility functions

> **Note**: All components are compatible with [Tailwind CSS v4](https://tailwindcss.com/blog/tailwindcss-v4) and [React 19](https://react.dev/blog/2024/12/05/react-19).

### Registry Build Process

```bash
# Build registry internally
pnpm registry:internal:build

# Build shadcn registry
pnpm registry:build
```

Auto-generated files (DO NOT EDIT):

- `src/__registry__/index.tsx`
- `src/__registry__/registry.autogenerated.json`
- `public/r/*.json`

## Development Guidelines

### Getting Started

```bash
# Install dependencies
pnpm install

# Start development server
pnpm dev  # Runs on port 1408

# Build for production
pnpm build
```

### Code Standards

- **TypeScript**: Strict mode enabled
- **ESLint**: Next.js configuration
- **Prettier**: Code formatting
- **File naming**: kebab-case for files, PascalCase for components

### Coding Guidelines

When writing code for this project, follow these principles:

**TypeScript & Documentation**

- Write type-safe TypeScript code with explicit types when necessary
- Add comments only when they clarify complex logic, function purpose, or non-obvious behavior
- Avoid obvious comments that merely restate the code
- Use descriptive variable and function names that make the code self-documenting
- Keep comments concise and focused on the "why" rather than the "what"

**Code Style**

- No emojis in code, comments, or commit messages
- Write clean, readable code that minimizes the need for extensive documentation
- Prefer self-explanatory code over commented code
- Use JSDoc for public APIs and exported functions when the signature alone isn't clear

**Best Practices**

- Follow SOLID principles and clean code practices
- Keep functions small and focused on a single responsibility
- Use meaningful names that reveal intent
- Write code that is easy to understand at first glance
- Avoid over-commenting; let the code speak for itself

### Component Development

1. Create component in `src/registry/[component-name]/`
2. Add to appropriate registry file (`registry-components.ts`, etc.)
3. Create examples in `src/registry/examples/`
4. Run registry build commands
5. Update documentation

## Web Interface Guidelines

Concise rules for building accessible, fast, delightful UIs. Use MUST/SHOULD/NEVER to guide decisions.

### Interactions

- Keyboard
  - MUST: Full keyboard support per [WAI-ARIA APG](https://www.w3.org/WAI/ARIA/apg/patterns/)
  - MUST: Visible focus rings (`:focus-visible`; group with `:focus-within`)
  - MUST: Manage focus (trap, move, and return) per APG patterns
- Targets & input
  - MUST: Hit target ≥24px (mobile ≥44px). If visual <24px, expand hit area
  - MUST: Mobile `<input>` font-size ≥16px or set:
    ```html
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
    />
    ```
  - NEVER: Disable browser zoom
  - MUST: `touch-action: manipulation` to prevent double-tap zoom; set `-webkit-tap-highlight-color` to match design
- Inputs & forms (behavior)
  - MUST: Hydration-safe inputs (no lost focus/value)
  - NEVER: Block paste in `<input>/<textarea>`
  - MUST: Loading buttons show spinner and keep original label
  - MUST: Enter submits focused text input. In `<textarea>`, ⌘/Ctrl+Enter submits; Enter adds newline
  - MUST: Keep submit enabled until request starts; then disable, show spinner, use idempotency key
  - MUST: Don’t block typing; accept free text and validate after
  - MUST: Allow submitting incomplete forms to surface validation
  - MUST: Errors inline next to fields; on submit, focus first error
  - MUST: `autocomplete` + meaningful `name`; correct `type` and `inputmode`
  - SHOULD: Disable spellcheck for emails/codes/usernames
  - SHOULD: Placeholders end with ellipsis and show example pattern (eg, `+1 (123) 456-7890`, `sk-012345…`)
  - MUST: Warn on unsaved changes before navigation
  - MUST: Compatible with password managers & 2FA; allow pasting one-time codes
  - MUST: Trim values to handle text expansion trailing spaces
  - MUST: No dead zones on checkboxes/radios; label+control share one generous hit target
- State & navigation
  - MUST: URL reflects state (deep-link filters/tabs/pagination/expanded panels). Prefer libs like [nuqs](https://nuqs.dev)
  - MUST: Back/Forward restores scroll
  - MUST: Links are links—use `<a>/<Link>` for navigation (support Cmd/Ctrl/middle-click)
- Feedback
  - SHOULD: Optimistic UI; reconcile on response; on failure show error and rollback or offer Undo
  - MUST: Confirm destructive actions or provide Undo window
  - MUST: Use polite `aria-live` for toasts/inline validation
  - SHOULD: Ellipsis (`…`) for options that open follow-ups (eg, "Rename…") and loading states (eg, "Loading…", "Saving…", "Generating…")
- Touch/drag/scroll
  - MUST: Design forgiving interactions (generous targets, clear affordances; avoid finickiness)
  - MUST: Delay first tooltip in a group; subsequent peers no delay
  - MUST: Intentional `overscroll-behavior: contain` in modals/drawers
  - MUST: During drag, disable text selection and set `inert` on dragged element/containers
  - MUST: No “dead-looking” interactive zones—if it looks clickable, it is
- Autofocus
  - SHOULD: Autofocus on desktop when there’s a single primary input; rarely on mobile (to avoid layout shift)

### Animation

- MUST: Honor `prefers-reduced-motion` (provide reduced variant)
- SHOULD: Prefer CSS > Web Animations API > JS libraries
- MUST: Animate compositor-friendly props (`transform`, `opacity`); avoid layout/repaint props (`top/left/width/height`)
- SHOULD: Animate only to clarify cause/effect or add deliberate delight
- SHOULD: Choose easing to match the change (size/distance/trigger)
- MUST: Animations are interruptible and input-driven (avoid autoplay)
- MUST: Correct `transform-origin` (motion starts where it “physically” should)

### Layout

- SHOULD: Optical alignment; adjust by ±1px when perception beats geometry
- MUST: Deliberate alignment to grid/baseline/edges/optical centers—no accidental placement
- SHOULD: Balance icon/text lockups (stroke/weight/size/spacing/color)
- MUST: Verify mobile, laptop, ultra-wide (simulate ultra-wide at 50% zoom)
- MUST: Respect safe areas (use env(safe-area-inset-\*))
- MUST: Avoid unwanted scrollbars; fix overflows

### Content & Accessibility

- SHOULD: Inline help first; tooltips last resort
- MUST: Skeletons mirror final content to avoid layout shift
- MUST: `<title>` matches current context
- MUST: No dead ends; always offer next step/recovery
- MUST: Design empty/sparse/dense/error states
- SHOULD: Curly quotes (“ ”); avoid widows/orphans
- MUST: Tabular numbers for comparisons (`font-variant-numeric: tabular-nums` or a mono like Geist Mono)
- MUST: Redundant status cues (not color-only); icons have text labels
- MUST: Don’t ship the schema—visuals may omit labels but accessible names still exist
- MUST: Use the ellipsis character `…` (not '...')
- MUST: `scroll-margin-top` on headings for anchored links; include a “Skip to content” link; hierarchical `<h1–h6>`
- MUST: Resilient to user-generated content (short/avg/very long)
- MUST: Locale-aware dates/times/numbers/currency
- MUST: Accurate names (`aria-label`), decorative elements `aria-hidden`, verify in the Accessibility Tree
- MUST: Icon-only buttons have descriptive `aria-label`
- MUST: Prefer native semantics (`button`, `a`, `label`, `table`) before ARIA
- SHOULD: Right-clicking the nav logo surfaces brand assets
- MUST: Use non-breaking spaces to glue terms: `10\u00A0MB`, `⌘\u00A0+\u00A0K`, `Vercel\u00A0SDK`

### Performance

- SHOULD: Test iOS Low Power Mode and macOS Safari
- MUST: Measure reliably (disable extensions that skew runtime)
- MUST: Track and minimize re-renders (React DevTools/React Scan)
- MUST: Profile with CPU/network throttling
- MUST: Batch layout reads/writes; avoid unnecessary reflows/repaints
- MUST: Mutations (`POST/PATCH/DELETE`) target <500 ms
- SHOULD: Prefer uncontrolled inputs; make controlled loops cheap (keystroke cost)
- MUST: Virtualize large lists (eg, `virtua`)
- MUST: Preload only above-the-fold images; lazy-load the rest
- MUST: Prevent CLS from images (explicit dimensions or reserved space)

### Design

- SHOULD: Layered shadows (ambient + direct)
- SHOULD: Crisp edges via semi-transparent borders + shadows
- SHOULD: Nested radii: child ≤ parent; concentric
- SHOULD: Hue consistency: tint borders/shadows/text toward bg hue
- MUST: Accessible charts (color-blind-friendly palettes)
- MUST: Meet contrast—prefer [APCA](https://apcacontrast.com/) over WCAG 2
- MUST: Increase contrast on `:hover/:active/:focus`
- SHOULD: Match browser UI to bg
- SHOULD: Avoid gradient banding (use masks when needed)

## Working with Content

### Blog Posts

- Location: `src/features/blog/content/`
- Format: MDX files
- Supports: Custom components, code blocks, metadata

### User Portfolio

**Portfolio Data Files** (`src/features/portfolio/data/`):

- `user.ts` - Core personal information, bio, contact details, job history
- `experiences.ts` - Detailed work experience, education, company information
- `projects.ts` - Portfolio projects with descriptions, links, skills, logos
- `tech-stack.ts` - Technology stack, programming languages, tools, frameworks
- `awards.ts` - Competition awards, prizes, academic achievements, certificates
- `certifications.ts` - Professional certifications, course completions, credentials
- `social-links.ts` - Social media profiles, professional networks, contact links
- `testimonials.ts` - Professional recommendations, endorsements from colleagues and clients

## Environment & Configuration

### Environment Variables

See `.env.example` for required variables:

**Core Application**:

- `APP_URL` - Application base URL (e.g., `https://acme.com`)

**Registry Configuration**:

- `REGISTRY_NAMESPACE` - Namespace identifier for shadcn CLI (e.g., `@acme`)
- `REGISTRY_NAMESPACE_URL` - URL pattern for component resolution (e.g., `https://acme.com/r/{name}.json`)

**External Services**:

- `GITHUB_API_TOKEN` - GitHub Personal Access Token for API calls ([Get token](https://github.com/settings/tokens))
- `NEXT_PUBLIC_DMCA_URL` - DMCA Protection badge URL ([DMCA ProtectionPro](https://www.dmca.com/ProtectionPro.aspx))

**Analytics & Tracking**:

- `NEXT_PUBLIC_POSTHOG_KEY` - PostHog project API key for analytics ([Get key](https://posthog.com))
- `NEXT_PUBLIC_POSTHOG_HOST` - PostHog API host URL (e.g., `https://ph.acme.com`)
- `NEXT_PUBLIC_POSTHOG_UI_HOST` - PostHog UI host URL (e.g., `https://us.i.posthog.com`)

### Analytics Events

The project uses PostHog for analytics tracking. Events are defined in `src/lib/events.ts` and tracked via `trackEvent()` function.

**Tracked Events**:

- `copy_npm_command` - User copies npm/pnpm/yarn/bun install command
  - Properties: `code` (command text)
- `copy_code_block` - User copies code block from blog/docs
  - Properties: `code` (code content)
- `play_name_pronunciation` - User plays name pronunciation audio
- `open_command_menu` - User opens command menu
  - Properties: `method` ("click" | "keyboard"), `key` (keyboard shortcut used)
- `command_menu_search` - User searches in command menu (debounced 500ms)
  - Properties: `query` (search text), `query_length` (query length)
- `command_menu_action` - User performs action in command menu
  - Navigation: Properties `action: "navigate"`, `href`, `open_in_new_tab`
  - Copy: Properties `action: "copy"`, `text` (copied content)
  - Theme: Properties `action: "change_theme"`, `theme` ("light" | "dark" | "system")
- `blog_search` - User searches blog posts (debounced 500ms)
  - Properties: `query` (search text), `query_length` (query length)

**Implementation Details**:

- Events use Zod schema validation for type safety
- PostHog initialized in `src/instrumentation-client.ts` (production only)
- Consent management via `@c15t/nextjs` package
- Cookieless mode enabled until user consent

### Site Configuration

- Navigation: `MAIN_NAV` in `src/config/site.ts`
- Theme colors: `META_THEME_COLORS`
- GitHub repo: `SOURCE_CODE_GITHUB_REPO`

## Common Tasks

### Adding a New Component

1. Create component directory: `src/registry/[name]/`
2. Implement component with proper TypeScript types
3. Add to `src/registry/registry-components.ts`
4. Create example in `src/registry/examples/`
5. Build registry: `pnpm registry:build`

### Updating User Information

Edit `src/features/portfolio/data/user.ts` with new:

- Personal information
- Job details
- Project descriptions
- Contact information

### Adding Blog Posts

1. Create MDX file in `src/features/blog/content/`
2. Include frontmatter metadata
3. Use custom components for enhanced content

### Styling Guidelines

- Use Tailwind CSS v4 syntax
- Follow existing color scheme (zinc-based)
- Support dark/light modes
- Use CSS variables for theme colors

## Important Notes

### Registry Dependencies

- Components may depend on external packages

### Auto-generated Files

**NEVER EDIT** these files directly:

- `src/__registry__/index.tsx`
- `src/__registry__/registry.autogenerated.json`
- Files in `public/r/`

### Performance Considerations

- Components use React.lazy() for code splitting
- Images optimized with Next.js Image component
- MDX content is statically generated

### Personal Information

When adapting this codebase, ensure ALL personal information is replaced:

**Key Areas to Update**:

- All files in `src/features/portfolio/data/` (see User Portfolio section above)
- `src/config/site.ts` - Site name, navigation, GitHub repo, UTM params
- Blog posts in `src/features/blog/content/`
- Asset URLs (images, logos, audio files) throughout the codebase

**Important**: Portfolio data contains encoded contact information (base64) and specific asset URLs that must be updated for your own use.

## Deployment

### Vercel Deployment

- Automatic deployment from GitHub
- Environment variables configured in Vercel dashboard
- Build command: `pnpm build`
- Output directory: `.next`

### Build Commands

```bash
pnpm build          # Production build
pnpm start          # Start production server
pnpm preview        # Build and preview locally
```

## Contributing

### Code Quality

- Run `pnpm lint` before committing
- Use `pnpm format:write` for code formatting
- Check types with `pnpm check-types`

### Testing Registry Components

- Test components in isolation
- Verify registry build process
- Test installation via shadcn CLI

---

**Note**: This is a personal portfolio project. When using as a template, ensure all personal information is removed and replaced with your own content.
